name: Auto PR to main
on:
  push:
    branches:
      - bandit-brain-system
jobs:
  create-pr:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4
      - name: Create or update PR
        uses: actions/github-script@v7
        with:
          script: |
            const { owner, repo } = context.repo;
            const head = 'bandit-brain-system';
            const base = 'main';
            const title = 'Bandit Brain System: LinUCB, API, simulator, BIS, CI';
            const body = 'Auto-created PR from bandit-brain-system to main.';
            const existing = await github.rest.pulls.list({ owner, repo, state: 'open', head: `${owner}:${head}`, base });
            if (existing.data && existing.data.length > 0) {
              core.info(`PR already exists: ${existing.data[0].html_url}`);
            } else {
              const pr = await github.rest.pulls.create({ owner, repo, head, base, title, body });
              core.info(`Created PR: ${pr.data.html_url}`);
            }
